<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv='X-UA-Compatible' content='IE=edge' />
		<meta http-equiv='content-type' content='text/html; charset=utf-8'/>

		<style>
			body {
				font-size: 110%;
			}

			.changelog {
				display: none;
			}

			.version {
				padding: 0.2em;
				font-weight: bold;
			}

			.version-current {
				color: #000;
				font-weight: bold;
			}

			.version-new {
				color: #518BDB;
				font-weight: bold;
			}

			.version-block {
				border-bottom: 1px solid #518BDB;
			}

			.version-block div {
				margin: 0.7em 0em;
			}

			.update {
				border-radius: 2px;
				color: #fff;
				font-weight: bold;
				padding: 0.2em 1em;
				text-decoration: none;
				background-color: #518BDB;
			}

			.download {
				border-radius: 2px;
				color: #fff;
				font-weight: bold;
				padding: 0.2em 1em;
				text-decoration: none;
				background-color: #518BDB;
			}

			.show-changelog {
				border-radius: 2px;
				text-decoration: none;
				padding: 0.2em 1em;
				background-color: #fff;
				border: 1px solid #518BDB;
				color: #518BDB;
			}

			.version-block {
				border-left: 4px solid #518BDB;
				padding-left: 1em;
			}

			.install {
				border-radius: 2px;
				color: #fff;
				font-weight: bold;
				padding: 0.2em 1em;
				text-decoration: none;
				background-color: #518BDB;
			}

			.uninstall {
				color: #ecebbd;
				font-weight: bold;
				padding: 1em;
				text-decoration: none;
			}
		</style>

		<script>
		function toggleChangelog(classname) {
			var element = document.getElementById(classname);
			if (element.style.display !== 'block') {
				element.style.display = 'block';
			} else {
				element.style.display = 'none';
			}
		}
		</script>
	</head>
	<body>
		{% macro show_chagelog(id, appInfo)%}
			<!-- {{id}} version changelog -->
			<div id="{{id}}-changelog" class="changelog">
				<h3>{{str_version_history}}</h3>

				{% for version in appInfo.versionsList %}
				<h4>{{version.version}} {{(version.date)}}</h4>
				<ul>
					{% for change in version.changes %}
					<li>{{change}}</li>
					{% endfor %}
				</ul>
				{% endfor %}
			</div>

		{%- endmacro %}

        {% macro outwiker_info(id, appInfo)%}
        {% set download_url = appInfo.appwebsite %}
		{% set update_url = appInfo.versionsList[0].downloads %}
        <div class="controls">
            {% if download_url %}
                <a class="download button" href="{{download_url}}">{{str_download}}</a>
            {% endif %}

            <a class="show-changelog button" href="#"  onclick="toggleChangelog('{{id}}-changelog');">{{str_more_info}}</a>
					</div>

			{{ show_chagelog(id, appInfo)}}

        {%- endmacro %}

        {% macro update_info(id, appInfo)%}
        {% set download_url = appInfo.appwebsite %}
		{% set update_url = appInfo.versionsList[0].downloads %}
        <div class="controls">
			<a class="update button" href="update:{{id}}">{{str_update}}</a>

            {% if download_url %}
                <a class="download button" href="{{download_url}}">{{str_download}}</a>
            {% endif %}

            <a class="show-changelog button" href="#"  onclick="toggleChangelog('{{id}}-changelog');">{{str_more_info}}</a>
			<a class="uninstall button" href="uninstall:{{id}}">{{str_uninstall}}</a>
					</div>

            {{ show_chagelog(id, appInfo)}}
        {%- endmacro %}

        {% macro noupdate_info(id, appInfo)%}
        {% set download_url = appInfo.appwebsite %}
		{% set update_url = appInfo.versionsList[0].downloads %}
        <div class="controls">
            {% if download_url %}
                <a class="download button" href="{{download_url}}">{{str_download}}</a>
            {% endif %}

            <a class="show-changelog button" href="#"  onclick="toggleChangelog('{{id}}-changelog');">{{str_more_info}}</a>
			<a class="uninstall button" href="uninstall:{{id}}">{{str_uninstall}}</a>
					</div>

            {{ show_chagelog(id, appInfo)}}
        {%- endmacro %}

        {% macro install_info(id, appInfo)%}
        {% set download_url = appInfo.appwebsite %}
		{% set update_url = appInfo.versionsList[0].downloads %}
        <div class="controls">
			<a class="install button" href="install:{{id}}">{{str_install}}</a>

            {% if download_url %}
                <a class="download button" href="{{download_url}}">{{str_download}}</a>
            {% endif %}

            <a class="show-changelog button" href="#"  onclick="toggleChangelog('{{id}}-changelog');">{{str_more_info}}</a>
					</div>

            {{ show_chagelog(id, appInfo)}}

        {%- endmacro %}

		<div class="outwiker-current">{{str_outwiker_current_version}}: <span class="version version-current">{{outwiker_current_version}}</span></div>
		<div class="version-block outwiker-version">

            {% if 'OUTWIKER_STABLE' in outwikerAppInfo%}
				<!-- Outwiker stable version block begin -->
				<div class="outwiker-latest-stable">{{str_outwiker_latest_stable_version}}: <span class="version version-new">{{outwikerAppInfo['OUTWIKER_STABLE'].currentVersionStr}}</span>
                {{ outwiker_info('OUTWIKER_STABLE', outwikerAppInfo['OUTWIKER_STABLE']) }}
				</div>
				<!-- Outwiker stable version block end -->
            {% endif %}

            {% if 'OUTWIKER_UNSTABLE' in outwikerAppInfo%}
				<!-- Outwiker unstable version block begin -->
				<div class="outwiker-latest-unstable">{{str_outwiker_latest_unstable_version}}: <span class="version version-new">{{outwikerAppInfo['OUTWIKER_UNSTABLE'].currentVersionStr}}</span>
					{{ outwiker_info('OUTWIKER_UNSTABLE', outwikerAppInfo['OUTWIKER_UNSTABLE']) }}
				</div>
				<!-- Outwiker unstable version block end -->
            {% endif %}
			</div>

		{% for pluginName, pluginInfo in updatedAppInfo.items() %}
                <!-- {{pluginName}} block begin -->
                <div class="version-block plugin-version {{pluginName|replace(' ', '_')}}">
                    <div class="title">{{pluginName}} <span class="version version-current">{{currentVersionsDict[pluginName]}}</span> &#x27f6; <span class="version version-new">{{pluginInfo.currentVersionStr}}</span></div>
                    {{ update_info(pluginName, pluginInfo) }}
                </div>
                <!-- {{pluginName}} block end -->
		{% endfor %}

		{% for pluginName, pluginInfo in installedAppInfo.items() %}
                <!-- {{pluginName}} block begin -->
                <div class="version-block plugin-version {{pluginName|replace(' ', '_')}}">
                    <div class="title">{{pluginName}} <span class="version version-current">{{currentVersionsDict[pluginName]}}</span> &#x27f6; <span class="version version-new">{{pluginInfo.currentVersionStr}}</span></div>
                    {{ noupdate_info(pluginName, pluginInfo) }}
                </div>
                <!-- {{pluginName}} block end -->
		{% endfor %}

		{% for pluginName, pluginInfo in otherAppInfo.items() %}
                <!-- {{pluginName}} block begin -->
                <div class="version-block plugin-version {{pluginName|replace(' ', '_')}}">
                    <div class="title">{{pluginName}} <span class="version version-new">{{pluginInfo.currentVersionStr}}</span></div>
                    {{ install_info(pluginName, pluginInfo) }}
                </div>
                <!-- {{pluginName}} block end -->
		{% endfor %}
	</body>
</html>
